<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quir√≥n AI - Tu gu√≠a del Campamento Mestizo</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Keyframes para la animaci√≥n flotante de part√≠culas */
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        /* Keyframes para la animaci√≥n de pulso de estrellas/rayos */
        @keyframes pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 0.3; }
        }

        .animate-bounce-dot {
            animation: bounce-dot 0.6s infinite alternate;
        }

        .animate-bounce-dot:nth-child(2) {
            animation-delay: 0.1s;
        }

        .animate-bounce-dot:nth-child(3) {
            animation-delay: 0.2s;
        }

        @keyframes bounce-dot {
            0% { transform: translateY(0); }
            100% { transform: translateY(-4px); }
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white relative overflow-hidden">

    <!-- Part√≠culas ambientales -->
    <div id="particle-container" class="absolute inset-0 pointer-events-none"></div>

    <!-- Estrellas de fondo -->
    <div class="absolute inset-0 pointer-events-none">
        <div class="absolute top-20 left-16 w-1 h-1 bg-gray-500 rounded-full opacity-60 animate-pulse"></div>
        <div class="absolute top-32 right-24 w-1.5 h-1.5 bg-gray-400 rounded-full opacity-40 animate-pulse" style="animation-delay: 0.5s;"></div>
        <div class="absolute top-40 left-1/3 w-1 h-1 bg-gray-500 rounded-full opacity-50 animate-pulse" style="animation-delay: 1s;"></div>
        <div class="absolute bottom-40 right-16 w-1.5 h-1.5 bg-gray-400 rounded-full opacity-60 animate-pulse" style="animation-delay: 1.5s;"></div>
        <div class="absolute bottom-60 left-20 w-1 h-1 bg-gray-500 rounded-full opacity-40 animate-pulse" style="animation-delay: 2s;"></div>
        <div class="absolute top-60 right-1/3 w-1 h-1 bg-gray-400 rounded-full opacity-50 animate-pulse" style="animation-delay: 2.5s;"></div>
        <div class="absolute bottom-80 left-1/2 w-1.5 h-1.5 bg-gray-500 rounded-full opacity-45 animate-pulse" style="animation-delay: 3s;"></div>
        <div class="absolute top-80 right-12 w-1 h-1 bg-gray-400 rounded-full opacity-55 animate-pulse" style="animation-delay: 0.8s;"></div>
    </div>

    <!-- Efectos de rayo sutil -->
    <div class="absolute top-10 left-10 w-32 h-0.5 bg-gradient-to-r from-transparent via-gray-500 to-transparent opacity-20 animate-pulse"></div>
    <div class="absolute bottom-20 right-20 w-24 h-0.5 bg-gradient-to-r from-transparent via-gray-400 to-transparent opacity-15 animate-pulse" style="animation-delay: 1s;"></div>

    <!-- Header -->
    <div class="bg-gradient-to-r from-gray-800 to-gray-700 shadow-2xl border-b-4 border-gray-600 relative z-10">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center space-x-4">
                <div class="bg-gray-600 p-3 rounded-full shadow-lg">
                    <!-- BookOpen Icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-gray-200 lucide lucide-book-open"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                </div>
                <div>
                    <h1 class="text-3xl font-bold text-gray-100">Quir√≥n AI</h1>
                    <p class="text-gray-300 mt-1">Tu gu√≠a experto en el mundo de los semidioses</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-6 max-w-4xl relative z-10">
        <!-- Quick Questions -->
        <div class="mb-6">
            <h3 class="text-lg font-semibold text-gray-300 mb-3">Preguntas r√°pidas:</h3>
            <div id="quick-questions-container" class="grid grid-cols-1 md:grid-cols-2 gap-2">
                <!-- Quick questions will be rendered here by JS -->
            </div>
        </div>

        <!-- Chat Messages -->
        <div id="messages-container" class="bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-2xl border border-gray-600 mb-4 h-96 overflow-y-auto p-4 space-y-4">
            <!-- Messages will be rendered here by JS -->
            <div id="messages-end-ref"></div>
        </div>

        <!-- Input Area -->
        <div class="bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-2xl border border-gray-600 p-4">
            <div class="flex items-center space-x-3">
                <div class="flex-1 relative">
                    <input
                        type="text"
                        id="input-text"
                        placeholder="Pregunta sobre Percy Jackson, los dioses, el campamento..."
                        class="w-full bg-gray-700 text-gray-100 placeholder-gray-400 px-4 py-3 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent"
                    />
                    <div class="absolute right-3 top-1/2 transform -translate-y-1/2 flex space-x-1">
                        <!-- Waves Icon SVG -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-500 lucide lucide-waves"><path d="M2 6c.3 4 2.5 8 9 8 3.4 0 5.8-2.2 7-3a6 6 0 0 1 3 4v2c-3.4 0-5.8 2.2-7 3a6 6 0 0 1-9-4V6z"/><path d="M2 12c.3 4 2.5 8 9 8 3.4 0 5.8 2.2-7 3a6 6 0 0 1 3 4v2c-3.4 0-5.8 2.2-7 3a6 6 0 0 1-9-4V12z"/></svg>
                        <!-- Zap Icon SVG -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-500 lucide lucide-zap"><path d="M4 14a1 1 0 0 1-.78-1.63L16.29 2.95a1 1 0 0 1 1.41.7l-9.4 17.57a1 1 0 0 1-1.41.7l-.01-.01L4 14z"/></svg>
                    </div>
                </div>
                <button
                    id="send-button"
                    class="bg-gray-600 hover:bg-gray-500 disabled:bg-gray-700 disabled:cursor-not-allowed text-white p-3 rounded-lg transition-all duration-200 hover:shadow-lg hover:scale-105"
                >
                    <!-- Send Icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 lucide lucide-send"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>
                </button>
            </div>

            <div class="flex items-center justify-between mt-3 text-xs text-gray-400">
                <span>üí° Pregunta sobre libros, personajes, dioses, batallas o el final</span>
                <span class="flex items-center space-x-1">
                    <!-- BookOpen Icon SVG -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-3 h-3 lucide lucide-book-open"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                    <span>Experto en mitolog√≠a griega</span>
                </span>
            </div>
        </div>
    </div>

    <!-- Decorative elements mejorados -->
    <div class="fixed bottom-4 right-4 opacity-10 animate-pulse">
        <!-- Shield Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-16 h-16 text-gray-400 lucide lucide-shield"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
    </div>
    <div class="fixed top-20 left-4 opacity-10 animate-pulse" style="animation-delay: 1s;">
        <!-- Zap Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-12 h-12 text-gray-400 lucide lucide-zap"><path d="M4 14a1 1 0 0 1-.78-1.63L16.29 2.95a1 1 0 0 1 1.41.7l-9.4 17.57a1 1 0 0 1-1.41.7l-.01-.01L4 14z"/></svg>
    </div>
    <div class="fixed bottom-20 left-8 opacity-10 animate-pulse" style="animation-delay: 2s;">
        <!-- Sparkles Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-10 h-10 text-gray-400 lucide lucide-sparkles"><path d="M9.914 1.252a.6.6 0 0 0-.928 0C7.79 3.097 4.14 4.568 2.488 6.22a.6.6 0 0 0-.012.836l1.378 1.378a.6.6 0 0 0 .836-.012c1.651-1.652 3.123-5.302 4.968-6.284Z"/><path d="M22.512 6.22a.6.6 0 0 0-.012-.836L21.122 4.006a.6.6 0 0 0-.836.012c-1.651 1.652-3.123 5.302-4.968 6.284a.6.6 0 0 0-.928 0C13.79 12.903 10.14 14.374 8.488 16.026a.6.6 0 0 0-.012.836l1.378 1.378a.6.6 0 0 0 .836-.012c1.651-1.652 3.123-5.302 4.968-6.284a.6.6 0 0 0 .928 0c1.722 1.05 5.372 2.522 7.024 4.174a.6.6 0 0 0-.012.836l-1.378 1.378a.6.6 0 0 0-.836-.012c-1.651-1.652-3.123-5.302-4.968-6.284a.6.6 0 0 0-.928 0c-.861.527-2.73 1.226-4.208 1.604"/><path d="M12 0c-1.55 1.55-2.06 4.67-2 6.95l.05.05c.06 2.38 1.32 4.75 3.5 6.6l.5.4c.15.15.35.25.55.3l.5.1c.2.05.4.05.6 0l.5-.1c.2-.05.4-.15.55-.3l.5-.4c2.18-1.85 3.44-4.22 3.5-6.6l.05-.05c.06-2.28-.45-5.4-2-6.95Z"/></svg>
    </div>
    <div class="fixed top-40 right-12 opacity-10 animate-pulse" style="animation-delay: 0.5s;">
        <!-- Waves Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-14 h-14 text-gray-400 lucide lucide-waves"><path d="M2 6c.3 4 2.5 8 9 8 3.4 0 5.8-2.2 7-3a6 6 0 0 1 3 4v2c-3.4 0-5.8 2.2-7 3a6 6 0 0 1-9-4V6z"/><path d="M2 12c.3 4 2.5 8 9 8 3.4 0 5.8 2.2-7 3a6 6 0 0 1 3 4v2c-3.4 0-5.8 2.2-7 3a6 6 0 0 1-9-4V12z"/></svg>
    </div>
    <div class="fixed bottom-60 right-20 opacity-10 animate-pulse" style="animation-delay: 1.5s;">
        <!-- BookOpen Icon SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-gray-400 lucide lucide-book-open"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
    </div>

    <script>
        // Definici√≥n de las variables de estado global
        let messages = [
            {
                id: 1,
                type: 'ai',
                content: '¬°Hola, semidi√≥s! Soy Quir√≥n, tu gu√≠a en el Campamento Mestizo. ¬øQu√© quieres saber sobre el mundo de Percy Jackson?',
                timestamp: new Date()
            }
        ];
        let inputText = '';
        let isTyping = false;
        let particles = [];
        let particleInterval;

        // Referencias a elementos del DOM
        const messagesContainer = document.getElementById('messages-container');
        const inputTextElement = document.getElementById('input-text');
        const sendButton = document.getElementById('send-button');
        const quickQuestionsContainer = document.getElementById('quick-questions-container');
        const messagesEndRef = document.getElementById('messages-end-ref');
        const particleCanvas = document.getElementById('particle-container');

        // Base de conocimiento de Percy Jackson
        const percyJacksonKnowledge = {
            personajes: {
                'percy': 'Percy Jackson, hijo de Poseid√≥n, protagonista de la saga. Puede controlar el agua, respirar bajo el agua y tiene fuerza sobrehumana. En el √∫ltimo libro recibe la bendici√≥n de la Estigia y se vuelve casi invulnerable.',
                'annabeth': 'Annabeth Chase, hija de Atenea, arquitecta brillante y estratega. Mejor amiga y luego novia de Percy. Es muy inteligente y usa un pu√±al de bronce celestial.',
                'grover': 'Grover Underwood, s√°tiro que es el mejor amigo y protector de Percy. Tiene la misi√≥n de encontrar al dios Pan.',
                'luke': 'Luke Castellan, hijo de Hermes. Inicialmente aliado, luego se convierte en el anfitri√≥n de Cronos. Se sacrifica al final para destruir al tit√°n.',
                'thalia': 'Thalia Grace, hija de Zeus. Fue convertida en √°rbol para proteger el campamento, luego resucit√≥ gracias al Vellocino. Se convierte en cazadora de Artemisa.',
                'nico': 'Nico di Angelo, hijo de Hades. Puede controlar los muertos, viajar por las sombras y invocar esqueletos. Su papel se vuelve m√°s importante a lo largo de la saga.',
                'bianca': 'Bianca di Angelo, hermana de Nico, hija de Hades. Se convierte en cazadora de Artemisa pero muere en una misi√≥n.',
                'clarisse': 'Clarisse La Rue, hija de Ares. Inicialmente rival de Percy, luego se convierte en aliada. Es muy fuerte y agresiva en combate.',
                'tyson': 'Tyson es un c√≠clope, medio hermano de Percy (tambi√©n hijo de Poseid√≥n). Trabaja en las forjas submarinas.',
                'beckendorf': 'Charles Beckendorf, hijo de Hefesto. Gran amigo de Percy y novio de Silena. Experto en explosivos.',
                'silena': 'Silena Beauregard, hija de Afrodita. Novia de Beckendorf y esp√≠a de Luke (luego se redime).',
                'rachel': 'Rachel Elizabeth Dare, mortal que puede ver a trav√©s de la Niebla. Se convierte en el nuevo Or√°culo.',
                'zoe': 'Zo√´ Nightshade, teniente de las Cazadoras de Artemisa. Pieza clave en "La Maldici√≥n del Tit√°n", donde se sacrifica.'
            },
            libros: {
                'ladron': 'El Ladr√≥n del Rayo: Percy descubre que es hijo de Poseid√≥n y es acusado de robar el rayo de Zeus. Viaja al inframundo y descubre que Luke es el verdadero ladr√≥n.',
                'mar': 'El Mar de los Monstruos: El √°rbol de Thalia est√° envenenado. Percy va al Mar de Bermudas por el Vellocino de Oro y Thalia resucita.',
                'maldicion': 'La Maldici√≥n del Tit√°n: Artemisa y Annabeth son capturadas. Percy se une a las cazadoras en una misi√≥n de rescate. Nico se revela como hijo de Hades.',
                'batalla': 'La Batalla del Laberinto: Cronos planea invadir por el Laberinto de D√©dalo. D√©dalo se sacrifica para destruir su creaci√≥n.',
                'ultimo': 'El √öltimo H√©roe del Olimpo: Guerra final contra Cronos en Nueva York. Luke se sacrifica para destruir a Cronos y Percy rechaza la inmortalidad.'
            },
            dioses: {
                'poseidon': 'Poseid√≥n, dios del mar y padre de Percy. Uno de los Tres Grandes junto con Zeus y Hades.',
                'zeus': 'Zeus, rey de los dioses, dios del rayo y el cielo. Padre de Thalia Grace.',
                'hades': 'Hades, dios del inframundo, padre de Nico y Bianca di Angelo. Inicialmente visto como villano.',
                'atenea': 'Atenea, diosa de la sabidur√≠a y la estrategia. Madre de Annabeth Chase.',
                'ares': 'Ares, dios de la guerra. Padre de Clarisse La Rue, agresivo y conflictivo.',
                'hermes': 'Hermes, dios mensajero y de los ladrones. Padre de Luke Castellan.',
                'artemisa': 'Artemisa, diosa de la caza. L√≠der de las Cazadoras, hermana gemela de Apolo.',
                'apolo': 'Apolo, dios del sol, la m√∫sica y las profec√≠as. Hermano gemelo de Artemisa.',
                'afrodita': 'Afrodita, diosa del amor. Madre de Silena Beauregard.',
                'hefesto': 'Hefesto, dios del fuego y la forja. Padre de Charles Beckendorf.',
                'dionisio': 'Dionisio (Sr. D), dios del vino. Director castigado del Campamento Mestizo.',
                'hera': 'Hera, diosa del matrimonio y reina del Olimpo. Esposa de Zeus.'
            },
            antagonistas: {
                'cronos': 'Cronos, tit√°n del tiempo y enemigo principal. Se reconstruye en un ata√∫d dorado y posee el cuerpo de Luke.',
                'atlas': 'Atlas, tit√°n condenado a cargar el cielo. Se al√≠a con Cronos en "La Maldici√≥n del Tit√°n".',
                'tifon': 'Tif√≥n, monstruo gigante que distrae a los dioses mientras Cronos ataca el Olimpo.',
                'kampe': 'Kamp√™, monstruo guardi√°n del T√°rtaro liberado por Cronos.',
                'polifemo': 'Polifemo, c√≠clope que captura a Grover en el Mar de los Monstruos.',
                'minotauro': 'El Minotauro, primer monstruo que Percy derrota al llegar al campamento.'
            },
            lugares: {
                'campamento': 'El Campamento Mestizo, refugio seguro para semidioses dirigido por Quir√≥n y Dionisio. Protegido por el √°rbol de Thalia.',
                'olimpo': 'El Monte Olimpo, hogar de los dioses que se mueve seg√∫n el coraz√≥n de la civilizaci√≥n occidental. En la saga est√° sobre el Empire State.',
                'inframundo': 'El Inframundo, reino de Hades. Percy lo visita en el primer libro para recuperar el rayo de Zeus.',
                'laberinto': 'El Laberinto de D√©dalo, construcci√≥n m√°gica que se extiende bajo todo el mundo y cambia constantemente.',
                'bermudas': 'El Mar de los Monstruos (Tri√°ngulo de las Bermudas), donde est√° la isla de Polifemo y el Vellocino de Oro.'
            },
            objetos: {
                'turbulencia': 'Turbulencia (Riptide), la espada de Percy hecha de bronce celestial. Siempre regresa a su bolsillo como bol√≠grafo.',
                'vellocino': 'El Vellocino de Oro, tiene poderes curativos y protectores. Rescatado en el segundo libro para salvar el campamento.',
                'gorra': 'La gorra de invisibilidad de Annabeth, regalo de su madre Atenea.',
                'rayo': 'El rayo maestro de Zeus, el arma m√°s poderosa del universo. Su robo inicia la primera aventura.',
                'ataud': 'El ata√∫d dorado de Cronos, donde el tit√°n se reconstruye a lo largo de la saga.'
            },
            temas: {
                'profecia': 'La Gran Profec√≠a habla de un hijo de los Tres Grandes que decidir√° el destino del Olimpo al cumplir 16 a√±os.',
                'lealtad': 'El tema central es que la lealtad y la amistad pesan m√°s que la fuerza.',
                'eleccion': 'Percy aprende que aunque el destino existe, las elecciones personales cambian el rumbo.',
                'familia': 'La relaci√≥n complicada entre dioses y semidioses, donde Percy logra que los dioses asuman m√°s responsabilidad.'
            }
        };

        const quickQuestions = [
            "¬øCu√°l es el orden de los libros?",
            "Cu√©ntame sobre Cronos",
            "¬øQui√©nes son los Tres Grandes?",
            "¬øC√≥mo termina la saga?",
            "¬øQu√© es la Gran Profec√≠a?",
            "H√°blame de Luke Castellan"
        ];

        // Funci√≥n para desplazar el chat hacia abajo
        function scrollToBottom() {
            messagesEndRef.scrollIntoView({ behavior: "smooth" });
        }

        // Funci√≥n para generar una respuesta de la IA
        function generateResponse(input) {
            const lowerInput = input.toLowerCase();

            // Buscar en libros espec√≠ficos
            for (const [key, value] of Object.entries(percyJacksonKnowledge.libros)) {
                if (lowerInput.includes(key) ||
                    (key === 'ladron' && (lowerInput.includes('ladr√≥n') || lowerInput.includes('rayo'))) ||
                    (key === 'mar' && lowerInput.includes('monstruos')) ||
                    (key === 'maldicion' && lowerInput.includes('maldici√≥n')) ||
                    (key === 'batalla' && lowerInput.includes('laberinto')) ||
                    (key === 'ultimo' && (lowerInput.includes('√∫ltimo') || lowerInput.includes('final')))) {
                    return `üìñ ${value} ¬øQuieres que te cuente m√°s detalles sobre esta aventura?`;
                }
            }

            // Buscar en personajes
            for (const [key, value] of Object.entries(percyJacksonKnowledge.personajes)) {
                if (lowerInput.includes(key) ||
                    (key === 'beckendorf' && lowerInput.includes('charles')) ||
                    (key === 'rachel' && lowerInput.includes('dare')) ||
                    (key === 'zoe' && (lowerInput.includes('zo√´') || lowerInput.includes('nightshade')))) {
                    return `üèõÔ∏è ${value} ¬øTe gustar√≠a saber algo m√°s espec√≠fico sobre este personaje?`;
                }
            }

            // Buscar en antagonistas
            for (const [key, value] = Object.entries(percyJacksonKnowledge.antagonistas)) {
                if (lowerInput.includes(key) ||
                    (key === 'tifon' && lowerInput.includes('tif√≥n')) ||
                    (key === 'kampe' && lowerInput.includes('kamp√™'))) {
                    return `üëπ ${value} Los villanos de Percy Jackson son realmente aterradores.`;
                }
            }

            // Buscar en dioses
            for (const [key, value] of Object.entries(percyJacksonKnowledge.dioses)) {
                if (lowerInput.includes(key) ||
                    (key === 'poseidon' && lowerInput.includes('poseid√≥n')) ||
                    (key === 'dionisio' && (lowerInput.includes('se√±or d') || lowerInput.includes('sr. d')))) {
                    return `‚ö° ${value} Los dioses ol√≠mpicos son muy poderosos pero tambi√©n muy complicados.`;
                }
            }

            // Buscar en lugares
            for (const [key, value] of Object.entries(percyJacksonKnowledge.lugares)) {
                if (lowerInput.includes(key) ||
                    (key === 'campamento' && lowerInput.includes('mestizo')) ||
                    (key === 'bermudas' && (lowerInput.includes('tri√°ngulo') || lowerInput.includes('bermudas')))) {
                    return `üèïÔ∏è ${value} Es un lugar muy importante en la saga.`;
                }
            }

            // Buscar en objetos
            for (const [key, value] of Object.entries(percyJacksonKnowledge.objetos)) {
                if (lowerInput.includes(key) ||
                    (key === 'vellocino' && (lowerInput.includes('vellocino') || lowerInput.includes('oro'))) ||
                    (key === 'ataud' && (lowerInput.includes('ata√∫d') || lowerInput.includes('dorado'))) ||
                    lowerInput.includes('espada') || lowerInput.includes('arma')) {
                    return `‚öîÔ∏è ${value} Los objetos m√°gicos son fundamentales en las aventuras.`;
                }
            }

            // Buscar en temas
            for (const [key, value] of Object.entries(percyJacksonKnowledge.temas)) {
                if (lowerInput.includes(key) ||
                    (key === 'profecia' && lowerInput.includes('profec√≠a')) ||
                    (key === 'eleccion' && (lowerInput.includes('elecci√≥n') || lowerInput.includes('destino')))) {
                    return `üéØ ${value} Este es uno de los temas m√°s profundos de la saga.`;
                }
            }

            // Preguntas espec√≠ficas sobre la saga
            if (lowerInput.includes('cronos') || lowerInput.includes('tit√°n')) {
                return `üëë Cronos es el tit√°n del tiempo y el enemigo principal de toda la saga. Se reconstruye en un ata√∫d dorado y al final posee el cuerpo de Luke. Su objetivo es destruir a los dioses ol√≠mpicos y recuperar el poder.`;
            }

            if (lowerInput.includes('tres grandes') || lowerInput.includes('big three')) {
                return `‚ö°üåäüíÄ Los Tres Grandes son Zeus (cielo), Poseid√≥n (mar) y Hades (inframundo). Hicieron un pacto de no tener m√°s hijos semidioses porque son muy poderosos, pero lo rompieron.`;
            }

            if (lowerInput.includes('cazadoras') || lowerInput.includes('artemisa')) {
                return `üèπ Las Cazadoras de Artemisa son chicas inmortales que renuncian al amor rom√°ntico para servir a la diosa. Thalia y Bianca se unieron a ellas. Son excelentes arqueras y cazadoras.`;
            }

            if (lowerInput.includes('orden') || lowerInput.includes('secuencia') || lowerInput.includes('cu√°ntos')) {
                return `üìö La saga tiene 5 libros en orden: 1) El Ladr√≥n del Rayo, 2) El Mar de los Monstruos, 3) La Maldici√≥n del Tit√°n, 4) La Batalla del Laberinto, 5) El √öltimo H√©roe del Olimpo. ¬°Tambi√©n existe Los H√©roes del Olimpo!`;
            }

            if (lowerInput.includes('final') || lowerInput.includes('termina') || lowerInput.includes('ending')) {
                return `üèÜ La saga termina con Luke sacrific√°ndose para destruir a Cronos. Percy rechaza la inmortalidad y pide que los dioses reconozcan a todos sus hijos. Al final, Percy y Annabeth quedan juntos y el Olimpo se renueva.`;
            }

            // Preguntas sobre poderes
            if (lowerInput.includes('poder') || lowerInput.includes('habilidad')) {
                return `‚ú® Los semidioses heredan poderes de sus padres divinos. Percy controla agua, Thalia electricidad, Nico los muertos, Annabeth tiene sabidur√≠a estrat√©gica. ¬°Cada hijo tiene habilidades √∫nicas seg√∫n su padre/madre divina!`;
            }

            // Respuestas generales mejoradas
            const generalResponses = [
                "üåä Como centauro sabio del campamento, conozco cada detalle de las aventuras de Percy. ¬øQuieres saber sobre alg√∫n libro espec√≠fico, personaje, o batalla √©pica?",
                "‚ö° En mis a√±os como entrenador he visto muchas historias heroicas. Preg√∫ntame sobre la Gran Profec√≠a, los Tres Grandes, o cualquier personaje de la saga.",
                "üèõÔ∏è El universo de Percy Jackson tiene 5 libros llenos de aventuras. ¬øTe interesa alg√∫n villano como Cronos, alg√∫n dios espec√≠fico, o quiz√°s sobre el Campamento Mestizo?",
                "üéØ Soy experto en mitolog√≠a griega y las aventuras desde El Ladr√≥n del Rayo hasta El √öltimo H√©roe del Olimpo. ¬øQu√© aspecto de la saga te llama m√°s la atenci√≥n?",
                "üìñ Desde que Percy lleg√≥ al campamento he sido testigo de batallas √©picas. Puedo contarte sobre Luke, las Cazadoras de Artemisa, el Laberinto de D√©dalo... ¬øPor d√≥nde empezamos?"
            ];

            return generalResponses[Math.floor(Math.random() * generalResponses.length)];
        }

        // Funci√≥n para renderizar los mensajes en el DOM
        function renderMessages() {
            messagesContainer.innerHTML = ''; // Limpiar mensajes existentes
            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`;

                const messageContent = document.createElement('div');
                messageContent.className = `max-w-xs lg:max-w-md px-4 py-3 rounded-2xl shadow-lg ${
                    message.type === 'user'
                        ? 'bg-gray-600 text-gray-100 rounded-br-sm'
                        : 'bg-gray-700 text-gray-200 rounded-bl-sm border border-gray-600'
                }`;

                if (message.type === 'ai') {
                    const aiHeader = document.createElement('div');
                    aiHeader.className = 'flex items-center space-x-2 mb-2';
                    aiHeader.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-400 lucide lucide-shield"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                        <span class="text-xs text-gray-400 font-semibold">Quir√≥n AI</span>
                    `;
                    messageContent.appendChild(aiHeader);
                }

                const messageText = document.createElement('p');
                messageText.className = 'text-sm leading-relaxed';
                messageText.textContent = message.content;
                messageContent.appendChild(messageText);

                const messageTimestamp = document.createElement('p');
                messageTimestamp.className = 'text-xs text-gray-400 mt-2';
                messageTimestamp.textContent = message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                messageContent.appendChild(messageTimestamp);

                messageElement.appendChild(messageContent);
                messagesContainer.appendChild(messageElement);
            });

            // A√±adir el indicador de escritura si es necesario
            if (isTyping) {
                const typingElement = document.createElement('div');
                typingElement.className = 'flex justify-start';
                typingElement.innerHTML = `
                    <div class="bg-gray-700 text-gray-200 px-4 py-3 rounded-2xl rounded-bl-sm shadow-lg border border-gray-600">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 text-gray-400 lucide lucide-shield"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                            <span class="text-xs text-gray-400 font-semibold">Quir√≥n AI</span>
                        </div>
                        <div class="flex space-x-1 mt-2">
                            <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce-dot"></div>
                            <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce-dot"></div>
                            <div class="w-2 h-2 bg-gray-500 rounded-full animate-bounce-dot"></div>
                        </div>
                    </div>
                `;
                messagesContainer.appendChild(typingElement);
            }

            messagesContainer.appendChild(messagesEndRef); // Asegurar que el ref est√© al final
            scrollToBottom();
        }

        // Manejador para enviar mensajes
        async function handleSendMessage() {
            if (!inputTextElement.value.trim()) return;

            const userMessage = {
                id: messages.length + 1,
                type: 'user',
                content: inputTextElement.value,
                timestamp: new Date()
            };

            messages = [...messages, userMessage];
            inputText = '';
            inputTextElement.value = ''; // Limpiar el input
            isTyping = true;

            renderMessages(); // Renderizar el mensaje del usuario y el indicador de escritura

            // Simular tiempo de respuesta
            setTimeout(() => {
                const aiResponse = {
                    id: messages.length + 1, // +1 porque el usuario ya agreg√≥ un mensaje
                    type: 'ai',
                    content: generateResponse(userMessage.content),
                    timestamp: new Date()
                };

                messages = [...messages, aiResponse];
                isTyping = false;
                renderMessages(); // Renderizar la respuesta de la IA
            }, 1000 + Math.random() * 2000);
        }

        // Manejador para la tecla Enter
        function handleKeyPress(e) {
            if (e.key === 'Enter') {
                handleSendMessage();
            }
        }

        // Inicializar part√≠culas ambientales
        function initParticles() {
            for (let i = 0; i < 15; i++) {
                const particleDiv = document.createElement('div');
                particleDiv.className = 'absolute rounded-full bg-gray-400';
                particleDiv.style.cssText = `
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    width: ${Math.random() * 6 + 2}px;
                    height: ${Math.random() * 6 + 2}px;
                    opacity: ${Math.random() * 0.3 + 0.1};
                    animation: float ${3 + i % 3}s ease-in-out infinite;
                    animation-delay: ${i * 0.2}s;
                `;
                particleCanvas.appendChild(particleDiv);
                particles.push({
                    element: particleDiv,
                    speed: Math.random() * 0.5 + 0.2,
                    y: parseFloat(particleDiv.style.top),
                    x: parseFloat(particleDiv.style.left)
                });
            }

            // Animar part√≠culas (actualiza la posici√≥n para un movimiento continuo si se quisiera, aunque el CSS ya maneja "float")
            // El c√≥digo original de React usaba una actualizaci√≥n de estado de `y` y `x` para un movimiento m√°s din√°mico,
            // pero el `float` de CSS es suficiente para el efecto visual deseado y es m√°s eficiente.
            // Si se necesitara el movimiento espec√≠fico original, se podr√≠a modificar el `top` y `left` de `particle.element.style` en un intervalo.
        }

        // Funci√≥n de inicializaci√≥n al cargar el DOM
        document.addEventListener('DOMContentLoaded', () => {
            renderMessages(); // Renderizar el mensaje inicial
            initParticles(); // Inicializar las part√≠culas

            // Renderizar las preguntas r√°pidas
            quickQuestions.forEach((question, index) => {
                const button = document.createElement('button');
                button.textContent = question;
                button.className = "bg-gray-700 hover:bg-gray-600 text-gray-200 px-4 py-2 rounded-lg text-left transition-all duration-200 hover:shadow-lg hover:scale-105 border border-gray-600";
                button.onclick = () => {
                    inputTextElement.value = question;
                    handleSendMessage();
                };
                quickQuestionsContainer.appendChild(button);
            });

            // A√±adir event listeners
            sendButton.addEventListener('click', handleSendMessage);
            inputTextElement.addEventListener('keypress', handleKeyPress);

            // Observador para detectar cambios en el array de mensajes y desplazar la vista
            const observer = new MutationObserver(() => scrollToBottom());
            observer.observe(messagesContainer, { childList: true });
        });
    </script>
</body>
</html>
